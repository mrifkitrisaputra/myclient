{
    "sourceFile": "src/main/java/com/client/entities/VisualExplosion.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1764832020997,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764835295536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n         \r\n         hAnimation = new Image[4];\r\n         vAnimation = new Image[4];\r\n         for (int i = 0; i < 4; i++) {\r\n-            hAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_horizontal\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n+            hAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_horizontal\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n             vAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_vertical\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n         }\r\n     }\r\n \r\n"
                },
                {
                    "date": 1764835307421,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n         this.centerY = startY;\r\n         this.parts = serverParts; // Terima daftar koordinat dari server\r\n \r\n         // Load Asset\r\n-        centerImg = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_largeexplosion1.png\"), tileSize, tileSize, false, false);\r\n+        centerImg = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_largeexplosion1.png\"), tileSize, tileSize, false, false);\r\n         \r\n         hAnimation = new Image[4];\r\n         vAnimation = new Image[4];\r\n         for (int i = 0; i < 4; i++) {\r\n"
                },
                {
                    "date": 1765192455235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,64 +1,101 @@\n package com.client.entities;\r\n \r\n-import java.util.List;\r\n-\r\n import javafx.scene.canvas.GraphicsContext;\r\n import javafx.scene.image.Image;\r\n+import javafx.scene.paint.Color;\r\n \r\n public class VisualExplosion {\r\n-    // Data visual murni\r\n-    public static record ExplosionPart(int x, int y, boolean isVertical) {}\r\n+    \r\n+    public final int tileX;\r\n+    public final int tileY;\r\n+    private final boolean isVertical;\r\n+    \r\n+    // Lifecycle: Menandakan animasi selesai agar dihapus dari GameState\r\n+    private boolean finished = false;\r\n \r\n-    private final int centerX, centerY;\r\n-    private final List<ExplosionPart> parts;\r\n-    \r\n     // Animasi\r\n-    private final Image centerImg;\r\n-    private final Image[] hAnimation; \r\n-    private final Image[] vAnimation; \r\n-\r\n+    private Image[] sprites;\r\n+    private final float frameDuration = 0.1f; // Kecepatan animasi (0.1 detik per frame)\r\n     private float animTimer = 0;\r\n     private int frameIndex = 0;\r\n-    private final int totalFrames = 4; \r\n+    \r\n+    // Status visual\r\n+    private boolean imageLoaded = false;\r\n     private final int tileSize = 32;\r\n \r\n-    // Constructor menerima parts yang sudah dihitung Server\r\n-    public VisualExplosion(int startX, int startY, List<ExplosionPart> serverParts) {\r\n-        this.centerX = startX;\r\n-        this.centerY = startY;\r\n-        this.parts = serverParts; // Terima daftar koordinat dari server\r\n+    // Constructor: Menerima 1 koordinat tile, bukan List\r\n+    public VisualExplosion(int x, int y, boolean isVertical) {\r\n+        this.tileX = x;\r\n+        this.tileY = y;\r\n+        this.isVertical = isVertical;\r\n \r\n-        // Load Asset\r\n-        centerImg = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_largeexplosion1.png\"), tileSize, tileSize, false, false);\r\n-        \r\n-        hAnimation = new Image[4];\r\n-        vAnimation = new Image[4];\r\n-        for (int i = 0; i < 4; i++) {\r\n-            hAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_horizontal\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n-            vAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_vertical\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n+        loadResources();\r\n+    }\r\n+\r\n+    private void loadResources() {\r\n+        try {\r\n+            // Kita siapkan array 4 frame (sesuai aset kamu)\r\n+            sprites = new Image[4];\r\n+            String type = isVertical ? \"vertical\" : \"horizontal\";\r\n+\r\n+            // Loop load e_horizontal1.png s/d e_horizontal4.png\r\n+            for (int i = 0; i < 4; i++) {\r\n+                String path = \"/com/client/assets/explosion/e_\" + type + (i + 1) + \".png\";\r\n+                sprites[i] = new Image(getClass().getResourceAsStream(path), tileSize, tileSize, false, false);\r\n+            }\r\n+            \r\n+            // Cek validitas gambar pertama\r\n+            if (!sprites[0].isError()) {\r\n+                imageLoaded = true;\r\n+            }\r\n+        } catch (Exception e) {\r\n+            System.err.println(\"GAGAL LOAD GAMBAR EXPLOSION: \" + e.getMessage());\r\n+            imageLoaded = false;\r\n         }\r\n     }\r\n \r\n     public void update(double dt) {\r\n-        // Hanya update animasi api membesar/mengecil\r\n-        float timePerFrame = 0.8f / totalFrames; \r\n+        if (finished) return;\r\n+\r\n         animTimer += dt;\r\n-        \r\n-        if (animTimer >= timePerFrame) {\r\n+        if (animTimer >= frameDuration) {\r\n             animTimer = 0;\r\n             frameIndex++;\r\n-            if (frameIndex >= totalFrames) frameIndex = totalFrames - 1; \r\n+            \r\n+            // Jika frame sudah melebihi jumlah sprite, animasi selesai\r\n+            if (imageLoaded && frameIndex >= sprites.length) {\r\n+                finished = true;\r\n+            } \r\n+            // Fallback logic jika gambar tidak ada (durasi manual)\r\n+            else if (!imageLoaded && frameIndex >= 5) {\r\n+                finished = true;\r\n+            }\r\n         }\r\n     }\r\n \r\n     public void render(GraphicsContext g) {\r\n-        // Render Pusat\r\n-        g.drawImage(centerImg, centerX * tileSize, centerY * tileSize);\r\n+        if (finished) return;\r\n \r\n-        // Render Bagian Api (Daftar koordinat dari Server)\r\n-        for (ExplosionPart part : parts) {\r\n-            Image sprite = part.isVertical ? vAnimation[frameIndex] : hAnimation[frameIndex];\r\n-            g.drawImage(sprite, part.x * tileSize, part.y * tileSize);\r\n+        double px = tileX * tileSize;\r\n+        double py = tileY * tileSize;\r\n+\r\n+        if (imageLoaded) {\r\n+            // Safety check array bounds\r\n+            if (frameIndex < sprites.length) {\r\n+                g.drawImage(sprites[frameIndex], px, py);\r\n+            }\r\n+        } else {\r\n+            // FALLBACK: Kotak Oranye Transparan\r\n+            g.setFill(Color.ORANGE.deriveColor(0, 1, 1, 0.7));\r\n+            g.fillRect(px, py, tileSize, tileSize);\r\n+            \r\n+            g.setStroke(Color.RED);\r\n+            g.strokeRect(px, py, tileSize, tileSize);\r\n         }\r\n     }\r\n+\r\n+    // Dipanggil oleh ClientGameState untuk bersih-bersih memory\r\n+    public boolean isFinished() {\r\n+        return finished;\r\n+    }\r\n }\n\\ No newline at end of file\n"
                }
            ],
            "date": 1764832020997,
            "name": "Commit-0",
            "content": "package com.client.entities;\r\n\r\nimport javafx.scene.canvas.GraphicsContext;\r\nimport javafx.scene.image.Image;\r\nimport java.util.List;\r\n\r\npublic class VisualExplosion {\r\n    // Data visual murni\r\n    public static record ExplosionPart(int x, int y, boolean isVertical) {}\r\n\r\n    private final int centerX, centerY;\r\n    private final List<ExplosionPart> parts;\r\n    \r\n    // Animasi\r\n    private final Image centerImg;\r\n    private final Image[] hAnimation; \r\n    private final Image[] vAnimation; \r\n\r\n    private float animTimer = 0;\r\n    private int frameIndex = 0;\r\n    private final int totalFrames = 4; \r\n    private final int tileSize = 32;\r\n\r\n    // Constructor menerima parts yang sudah dihitung Server\r\n    public VisualExplosion(int startX, int startY, List<ExplosionPart> serverParts) {\r\n        this.centerX = startX;\r\n        this.centerY = startY;\r\n        this.parts = serverParts; // Terima daftar koordinat dari server\r\n\r\n        // Load Asset\r\n        centerImg = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_largeexplosion1.png\"), tileSize, tileSize, false, false);\r\n        \r\n        hAnimation = new Image[4];\r\n        vAnimation = new Image[4];\r\n        for (int i = 0; i < 4; i++) {\r\n            hAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_horizontal\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n            vAnimation[i] = new Image(getClass().getResourceAsStream(\"/com/client/assets/explosion/e_vertical\" + (i+1) + \".png\"), tileSize, tileSize, false, false);\r\n        }\r\n    }\r\n\r\n    public void update(double dt) {\r\n        // Hanya update animasi api membesar/mengecil\r\n        float timePerFrame = 0.8f / totalFrames; \r\n        animTimer += dt;\r\n        \r\n        if (animTimer >= timePerFrame) {\r\n            animTimer = 0;\r\n            frameIndex++;\r\n            if (frameIndex >= totalFrames) frameIndex = totalFrames - 1; \r\n        }\r\n    }\r\n\r\n    public void render(GraphicsContext g) {\r\n        // Render Pusat\r\n        g.drawImage(centerImg, centerX * tileSize, centerY * tileSize);\r\n\r\n        // Render Bagian Api (Daftar koordinat dari Server)\r\n        for (ExplosionPart part : parts) {\r\n            Image sprite = part.isVertical ? vAnimation[frameIndex] : hAnimation[frameIndex];\r\n            g.drawImage(sprite, part.x * tileSize, part.y * tileSize);\r\n        }\r\n    }\r\n}"
        }
    ]
}