{
    "sourceFile": "src/main/java/com/client/ui/GameOverPopup.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1764831883081,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764834459689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,10 +1,7 @@\n-// src/main/java/com/client/ui/GameOverPopup.java\r\n-package com.client.ui;\r\n+package com.myclient.ui;\r\n \r\n-import com.client.App;\r\n-import com.client.managers.RoomManager;\r\n-\r\n+import com.myclient.App;\r\n import javafx.geometry.Pos;\r\n import javafx.scene.control.Button;\r\n import javafx.scene.control.Label;\r\n import javafx.scene.layout.HBox;\r\n@@ -14,13 +11,8 @@\n import javafx.scene.text.FontWeight;\r\n \r\n public class GameOverPopup extends VBox {\r\n \r\n-    private int voteCount = 0;\r\n-    private final int MIN_VOTES = 3;\r\n-    private Label lblVotes;\r\n-    private Button btnRematch;\r\n-\r\n     public GameOverPopup(boolean isWin) {\r\n         this.setAlignment(Pos.CENTER);\r\n         this.setSpacing(20);\r\n         this.setStyle(\"-fx-background-color: rgba(0, 0, 0, 0.9); -fx-padding: 40; -fx-background-radius: 20;\");\r\n@@ -30,68 +22,47 @@\n         title.setFont(Font.font(\"Segoe UI\", FontWeight.BOLD, 48));\r\n         title.setTextFill(isWin ? Color.GOLD : Color.RED);\r\n \r\n         // --- REMATCH SECTION ---\r\n-        lblVotes = new Label(\"Rematch Votes: 0/\" + MIN_VOTES);\r\n-        lblVotes.setTextFill(Color.WHITE);\r\n-        lblVotes.setFont(Font.font(18));\r\n+        Label lblInfo = new Label(\"Vote to play again...\");\r\n+        lblInfo.setTextFill(Color.WHITE);\r\n+        lblInfo.setFont(Font.font(18));\r\n \r\n-        btnRematch = new Button(\"Vote Rematch\");\r\n+        Button btnRematch = new Button(\"Vote Rematch\");\r\n         styleButton(btnRematch, \"#2980b9\"); // Biru\r\n \r\n-        btnRematch.setOnAction(e -> handleVote());\r\n+        // Logic Vote Rematch\r\n+        btnRematch.setOnAction(e -> {\r\n+            // 1. Disable tombol agar tidak spam\r\n+            btnRematch.setDisable(true);\r\n+            btnRematch.setText(\"Waiting for others...\");\r\n \r\n-        // Tombol Host (Accept Rematch) - Awalnya hidden\r\n-        Button btnHostAccept = new Button(\"START REMATCH\");\r\n-        styleButton(btnHostAccept, \"#27ae60\"); // Hijau\r\n-        btnHostAccept.setVisible(false); // Muncul jika vote cukup & user adalah host\r\n-\r\n-        // Logic Simulasi jika vote terpenuhi\r\n-        btnHostAccept.setOnAction(e -> {\r\n-            App.startGame(App.currentStage); // Restart Game\r\n+            // 2. Kirim sinyal ke Server\r\n+            if (App.network != null) {\r\n+                App.network.send(\"VOTE_REMATCH\");\r\n+            }\r\n         });\r\n \r\n         // --- LEAVE BUTTON ---\r\n         Button btnLeave = new Button(\"Leave Room\");\r\n         styleButton(btnLeave, \"#c0392b\"); // Merah\r\n+        \r\n         btnLeave.setOnAction(e -> {\r\n-            RoomManager.playerLeft(\"Player 1 (You)\"); // Trigger logic keluar\r\n+            // 1. Kirim sinyal keluar\r\n+            if (App.network != null) {\r\n+                App.network.send(\"LEAVE_ROOM\");\r\n+            }\r\n+            \r\n+            // 2. Kembali ke Lobby\r\n             SceneManager.toLobby();\r\n         });\r\n \r\n         HBox buttonBox = new HBox(20, btnLeave, btnRematch);\r\n         buttonBox.setAlignment(Pos.CENTER);\r\n \r\n-        this.getChildren().addAll(title, lblVotes, buttonBox, btnHostAccept);\r\n-\r\n-        // Simpan referensi button host biar bisa diupdate\r\n-        this.btnHostStart = btnHostAccept;\r\n+        this.getChildren().addAll(title, lblInfo, buttonBox);\r\n     }\r\n-    \r\n-    private Button btnHostStart;\r\n \r\n-    private void handleVote() {\r\n-        btnRematch.setDisable(true); // Disable biar gak spam vote\r\n-        btnRematch.setText(\"Voted!\");\r\n-        \r\n-        // SIMULASI: Anggap player lain langsung setuju\r\n-        voteCount++; // Vote kita\r\n-        updateVoteUI();\r\n-\r\n-        // Simulasi delay bot voting (pake thread sleep ala-ala atau langsung aja)\r\n-        voteCount += 2; // Simulasi 2 player lain vote\r\n-        updateVoteUI();\r\n-    }\r\n-\r\n-    private void updateVoteUI() {\r\n-        lblVotes.setText(\"Rematch Votes: \" + voteCount + \"/\" + MIN_VOTES);\r\n-        \r\n-        // Jika vote cukup DAN kita adalah HOST -> Tampilkan tombol Start\r\n-        if (voteCount >= MIN_VOTES && RoomManager.isHost()) {\r\n-            btnHostStart.setVisible(true);\r\n-        }\r\n-    }\r\n-\r\n     private void styleButton(Button btn, String color) {\r\n         btn.setStyle(\"-fx-background-color: \" + color + \"; -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;\");\r\n         btn.setPrefSize(160, 40);\r\n     }\r\n"
                },
                {
                    "date": 1764834465312,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-package com.myclient.ui;\r\n+package com.client.ui;\r\n \r\n import com.myclient.App;\r\n import javafx.geometry.Pos;\r\n import javafx.scene.control.Button;\r\n"
                }
            ],
            "date": 1764831883081,
            "name": "Commit-0",
            "content": "// src/main/java/com/client/ui/GameOverPopup.java\r\npackage com.client.ui;\r\n\r\nimport com.client.App;\r\nimport com.client.managers.RoomManager;\r\n\r\nimport javafx.geometry.Pos;\r\nimport javafx.scene.control.Button;\r\nimport javafx.scene.control.Label;\r\nimport javafx.scene.layout.HBox;\r\nimport javafx.scene.layout.VBox;\r\nimport javafx.scene.paint.Color;\r\nimport javafx.scene.text.Font;\r\nimport javafx.scene.text.FontWeight;\r\n\r\npublic class GameOverPopup extends VBox {\r\n\r\n    private int voteCount = 0;\r\n    private final int MIN_VOTES = 3;\r\n    private Label lblVotes;\r\n    private Button btnRematch;\r\n\r\n    public GameOverPopup(boolean isWin) {\r\n        this.setAlignment(Pos.CENTER);\r\n        this.setSpacing(20);\r\n        this.setStyle(\"-fx-background-color: rgba(0, 0, 0, 0.9); -fx-padding: 40; -fx-background-radius: 20;\");\r\n        this.setMaxSize(500, 400);\r\n\r\n        Label title = new Label(isWin ? \"VICTORY!\" : \"YOU DIED\");\r\n        title.setFont(Font.font(\"Segoe UI\", FontWeight.BOLD, 48));\r\n        title.setTextFill(isWin ? Color.GOLD : Color.RED);\r\n\r\n        // --- REMATCH SECTION ---\r\n        lblVotes = new Label(\"Rematch Votes: 0/\" + MIN_VOTES);\r\n        lblVotes.setTextFill(Color.WHITE);\r\n        lblVotes.setFont(Font.font(18));\r\n\r\n        btnRematch = new Button(\"Vote Rematch\");\r\n        styleButton(btnRematch, \"#2980b9\"); // Biru\r\n\r\n        btnRematch.setOnAction(e -> handleVote());\r\n\r\n        // Tombol Host (Accept Rematch) - Awalnya hidden\r\n        Button btnHostAccept = new Button(\"START REMATCH\");\r\n        styleButton(btnHostAccept, \"#27ae60\"); // Hijau\r\n        btnHostAccept.setVisible(false); // Muncul jika vote cukup & user adalah host\r\n\r\n        // Logic Simulasi jika vote terpenuhi\r\n        btnHostAccept.setOnAction(e -> {\r\n            App.startGame(App.currentStage); // Restart Game\r\n        });\r\n\r\n        // --- LEAVE BUTTON ---\r\n        Button btnLeave = new Button(\"Leave Room\");\r\n        styleButton(btnLeave, \"#c0392b\"); // Merah\r\n        btnLeave.setOnAction(e -> {\r\n            RoomManager.playerLeft(\"Player 1 (You)\"); // Trigger logic keluar\r\n            SceneManager.toLobby();\r\n        });\r\n\r\n        HBox buttonBox = new HBox(20, btnLeave, btnRematch);\r\n        buttonBox.setAlignment(Pos.CENTER);\r\n\r\n        this.getChildren().addAll(title, lblVotes, buttonBox, btnHostAccept);\r\n\r\n        // Simpan referensi button host biar bisa diupdate\r\n        this.btnHostStart = btnHostAccept;\r\n    }\r\n    \r\n    private Button btnHostStart;\r\n\r\n    private void handleVote() {\r\n        btnRematch.setDisable(true); // Disable biar gak spam vote\r\n        btnRematch.setText(\"Voted!\");\r\n        \r\n        // SIMULASI: Anggap player lain langsung setuju\r\n        voteCount++; // Vote kita\r\n        updateVoteUI();\r\n\r\n        // Simulasi delay bot voting (pake thread sleep ala-ala atau langsung aja)\r\n        voteCount += 2; // Simulasi 2 player lain vote\r\n        updateVoteUI();\r\n    }\r\n\r\n    private void updateVoteUI() {\r\n        lblVotes.setText(\"Rematch Votes: \" + voteCount + \"/\" + MIN_VOTES);\r\n        \r\n        // Jika vote cukup DAN kita adalah HOST -> Tampilkan tombol Start\r\n        if (voteCount >= MIN_VOTES && RoomManager.isHost()) {\r\n            btnHostStart.setVisible(true);\r\n        }\r\n    }\r\n\r\n    private void styleButton(Button btn, String color) {\r\n        btn.setStyle(\"-fx-background-color: \" + color + \"; -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;\");\r\n        btn.setPrefSize(160, 40);\r\n    }\r\n}"
        }
    ]
}