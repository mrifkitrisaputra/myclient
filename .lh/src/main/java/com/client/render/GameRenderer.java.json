{
    "sourceFile": "src/main/java/com/client/render/GameRenderer.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1764831883099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764832517554,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,12 +1,11 @@\n-package com.client.render;\r\n+package com.myclient.render;\r\n \r\n-import com.client.core.Arena;\r\n-import com.client.core.GameTimer;\r\n-import com.client.entities.Player;\r\n-import com.client.managers.BombManager; // IMPORT BARU\r\n-import com.client.managers.ExplosionManager;\r\n-import com.client.managers.ItemManager;\r\n+import com.myclient.ClientGameState;\r\n+import com.myclient.entities.VisualBomb;\r\n+import com.myclient.entities.VisualExplosion;\r\n+import com.myclient.entities.VisualItem;\r\n+import com.myclient.entities.VisualPlayer;\r\n \r\n import javafx.scene.canvas.GraphicsContext;\r\n import javafx.scene.image.Image;\r\n import javafx.scene.paint.Color;\r\n@@ -14,129 +13,106 @@\n \r\n public class GameRenderer {\r\n \r\n     private final GameCanvas canvas;\r\n-    private final Player player;\r\n-    private final int[][] map;\r\n-    private final BombManager bombs;\r\n-    private final ExplosionManager explosions;\r\n-    private final ItemManager itemManager; // FIELD BARU\r\n-\r\n-    private final CameraScaler scaler; // (Tambahkan field scaler yg sebelumnya lupa di-declare di snippet mu)\r\n-    private final GameTimer timer;\r\n-    private final Arena arena;\r\n-\r\n+    private final ClientGameState gameState;\r\n+    private final CameraScaler scaler;\r\n+    \r\n+    private final int tile = 32;\r\n     private final Image ground, breakable, unbreak;\r\n-    private final int tile;\r\n \r\n-    public GameRenderer(GameCanvas canvas, Player player, int[][] map,\r\n-            BombManager bombs, ExplosionManager explosions,\r\n-            ItemManager itemManager, // PARAMETER BARU\r\n-            CameraScaler scaler, GameTimer timer, Arena arena) {\r\n+    public GameRenderer(GameCanvas canvas, ClientGameState gameState, CameraScaler scaler) {\r\n         this.canvas = canvas;\r\n-        this.player = player;\r\n-        this.map = map;\r\n-        this.bombs = bombs;\r\n-        this.explosions = explosions;\r\n-        this.itemManager = itemManager; // SIMPAN\r\n+        this.gameState = gameState;\r\n         this.scaler = scaler;\r\n-        this.timer = timer;\r\n-        this.arena = arena;\r\n-        this.tile = canvas.getTileSize();\r\n \r\n-        // Load images\r\n+        // Load Tiles\r\n         ground = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/ground.png\"), tile, tile, false, false);\r\n         breakable = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/break.png\"), tile, tile, false, false);\r\n         unbreak = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/unbreak.png\"), tile, tile, false, false);\r\n     }\r\n \r\n     public void render() {\r\n         GraphicsContext g = canvas.getGraphicsContext2D();\r\n-        g.setFill(Color.web(\"#2c3e50\")); // Warna Dark Blue-Grey (Ala Discord/Modern UI)\r\n+\r\n+        // 1. Bersihkan Layar\r\n+        g.setFill(Color.web(\"#2c3e50\"));\r\n         g.fillRect(0, 0, canvas.getWidth(), canvas.getHeight());\r\n \r\n-        double offsetX = canvas.getOffsetX();\r\n-        double offsetY = canvas.getOffsetY();\r\n-        double scale = canvas.getRenderScale();\r\n+        // Cek apakah data map sudah diterima dari server?\r\n+        int[][] map = gameState.getMap();\r\n+        if (map == null) {\r\n+            renderLoading(g);\r\n+            return;\r\n+        }\r\n \r\n+        // Hitung Offset agar map di tengah\r\n+        double scale = scaler.getScale();\r\n+        double mapPixelW = map.length * tile * scale;\r\n+        double mapPixelH = map[0].length * tile * scale;\r\n+        double offsetX = (canvas.getWidth() - mapPixelW) / 2.0;\r\n+        double offsetY = (canvas.getHeight() - mapPixelH) / 2.0;\r\n+\r\n         g.save();\r\n         g.translate(offsetX, offsetY);\r\n         g.scale(scale, scale);\r\n \r\n-        // 1. Map\r\n-        renderMap(g);\r\n+        // 2. Render Map\r\n+        renderMap(g, map);\r\n \r\n-        // 2. Arena Highlight\r\n-        renderArenaShrink(g);\r\n+        // 3. Render Entities (Loop dari list di GameState)\r\n+        for (VisualItem item : gameState.getItems()) {\r\n+            item.render(g);\r\n+        }\r\n \r\n-        // 3. Items (Render item di atas tanah, di bawah player)\r\n-        itemManager.render(g);\r\n+        for (VisualBomb bomb : gameState.getBombs()) {\r\n+            bomb.render(g);\r\n+        }\r\n \r\n-        // 4. Objects\r\n-        bombs.render(g);\r\n-        explosions.render(g);\r\n+        for (VisualExplosion exp : gameState.getExplosions()) {\r\n+            exp.render(g);\r\n+        }\r\n \r\n-        boolean animSelesai = player.isDeathAnimFinished();\r\n-\r\n-        // Jika animasi BELUM selesai, tetap gambar (biarpun mati)\r\n-        // Jika animasi SUDAH selesai, skip baris ini (Player Hilang)\r\n-        if (!animSelesai) {\r\n-             g.drawImage(player.update(1/60.0), player.x, player.y);\r\n+        for (VisualPlayer player : gameState.getPlayers()) {\r\n+            player.render(g);\r\n         }\r\n         \r\n         g.restore();\r\n+\r\n+        // 4. Render UI\r\n         renderUI(g);\r\n     }\r\n \r\n-    private void renderMap(GraphicsContext g) {\r\n-        for (int y = 0; y < map[0].length; y++) {\r\n-            for (int x = 0; x < map.length; x++) {\r\n-                Image img;\r\n-                if (map[x][y] == 1) {\r\n-                    img = unbreak; \r\n-                }else if (map[x][y] == 2) {\r\n-                    img = breakable; \r\n-                }else {\r\n-                    img = ground;\r\n-                }\r\n-\r\n+    private void renderMap(GraphicsContext g, int[][] map) {\r\n+        for (int x = 0; x < map.length; x++) {\r\n+            for (int y = 0; y < map[0].length; y++) {\r\n+                int type = map[x][y];\r\n+                Image img = switch(type) {\r\n+                    case 1 -> unbreak;\r\n+                    case 2 -> breakable;\r\n+                    default -> ground;\r\n+                };\r\n                 g.drawImage(img, x * tile, y * tile);\r\n             }\r\n         }\r\n     }\r\n \r\n-    private void renderArenaShrink(GraphicsContext g) {\r\n-        if (!arena.isShrinking()) {\r\n-            return;\r\n-        }\r\n+    private void renderLoading(GraphicsContext g) {\r\n+        g.setFill(Color.WHITE);\r\n+        g.setFont(new Font(\"Arial\", 30));\r\n+        g.fillText(\"Connecting to Server...\", canvas.getWidth()/2 - 100, canvas.getHeight()/2);\r\n+    }\r\n \r\n-        double alpha = 0.4 + 0.4 * Math.sin(arena.getShrinkAnimTimer() * 20);\r\n-        g.setFill(Color.rgb(255, 0, 0, alpha));\r\n-\r\n-        int left = arena.getLeft();\r\n-        int right = arena.getRight();\r\n-        int top = arena.getTop();\r\n-        int bottom = arena.getBottom();\r\n-\r\n-        String step = arena.getCurrentStepPattern();\r\n-\r\n-        if (\"LR\".equals(step)) {\r\n-            g.fillRect(left * 32, 0, 32, map[0].length * 32);\r\n-            g.fillRect(right * 32, 0, 32, map[0].length * 32);\r\n-        } else if (\"TB\".equals(step)) {\r\n-            g.fillRect(0, top * 32, map.length * 32, 32);\r\n-            g.fillRect(0, bottom * 32, map.length * 32, 32);\r\n+    private void renderUI(GraphicsContext g) {\r\n+        // Timer atau Info Game dari GameState\r\n+        if (gameState.isGameOver()) {\r\n+            g.setFill(Color.RED);\r\n+            g.setFont(new Font(\"Impact\", 60));\r\n+            g.fillText(\"GAME OVER\", canvas.getWidth()/2 - 150, canvas.getHeight()/2);\r\n         }\r\n-    }\r\n \r\n-    private void renderUI(GraphicsContext g) {\r\n-        g.save();\r\n-        g.setFont(new Font(\"Consolas\", 48));\r\n+        // Render Game Timer (dikirim server)\r\n         g.setFill(Color.WHITE);\r\n-        g.setStroke(Color.BLACK);\r\n-        g.setLineWidth(2);\r\n-        String t = timer.toString();\r\n-        g.strokeText(t, canvas.getWidth() - 150, 60);\r\n-        g.fillText(t, canvas.getWidth() - 150, 60);\r\n-        g.restore();\r\n+        g.setFont(new Font(\"Consolas\", 30));\r\n+        g.fillText(\"Time: \" + (int)gameState.getGameTime(), 20, 40);\r\n     }\r\n-}\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1764832522769,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-package com.myclient.render;\r\n+package com.client.render;\r\n \r\n import com.myclient.ClientGameState;\r\n import com.myclient.entities.VisualBomb;\r\n import com.myclient.entities.VisualExplosion;\r\n"
                },
                {
                    "date": 1764832529014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n package com.client.render;\r\n \r\n import com.client.ClientGameState;\r\n import com.client.entities.VisualBomb;\r\n-import com.myclient.entities.VisualExplosion;\r\n+import com.client.entities.VisualExplosion;\r\n import com.myclient.entities.VisualItem;\r\n import com.myclient.entities.VisualPlayer;\r\n \r\n import javafx.scene.canvas.GraphicsContext;\r\n"
                },
                {
                    "date": 1764835090182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,9 @@\n         this.gameState = gameState;\r\n         this.scaler = scaler;\r\n \r\n         // Load Tiles\r\n-        ground = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/ground.png\"), tile, tile, false, false);\r\n+        ground = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/ground.png\"), tile, tile, false, false);\r\n         breakable = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/break.png\"), tile, tile, false, false);\r\n         unbreak = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/unbreak.png\"), tile, tile, false, false);\r\n     }\r\n \r\n"
                }
            ],
            "date": 1764831883099,
            "name": "Commit-0",
            "content": "package com.client.render;\r\n\r\nimport com.client.core.Arena;\r\nimport com.client.core.GameTimer;\r\nimport com.client.entities.Player;\r\nimport com.client.managers.BombManager; // IMPORT BARU\r\nimport com.client.managers.ExplosionManager;\r\nimport com.client.managers.ItemManager;\r\n\r\nimport javafx.scene.canvas.GraphicsContext;\r\nimport javafx.scene.image.Image;\r\nimport javafx.scene.paint.Color;\r\nimport javafx.scene.text.Font;\r\n\r\npublic class GameRenderer {\r\n\r\n    private final GameCanvas canvas;\r\n    private final Player player;\r\n    private final int[][] map;\r\n    private final BombManager bombs;\r\n    private final ExplosionManager explosions;\r\n    private final ItemManager itemManager; // FIELD BARU\r\n\r\n    private final CameraScaler scaler; // (Tambahkan field scaler yg sebelumnya lupa di-declare di snippet mu)\r\n    private final GameTimer timer;\r\n    private final Arena arena;\r\n\r\n    private final Image ground, breakable, unbreak;\r\n    private final int tile;\r\n\r\n    public GameRenderer(GameCanvas canvas, Player player, int[][] map,\r\n            BombManager bombs, ExplosionManager explosions,\r\n            ItemManager itemManager, // PARAMETER BARU\r\n            CameraScaler scaler, GameTimer timer, Arena arena) {\r\n        this.canvas = canvas;\r\n        this.player = player;\r\n        this.map = map;\r\n        this.bombs = bombs;\r\n        this.explosions = explosions;\r\n        this.itemManager = itemManager; // SIMPAN\r\n        this.scaler = scaler;\r\n        this.timer = timer;\r\n        this.arena = arena;\r\n        this.tile = canvas.getTileSize();\r\n\r\n        // Load images\r\n        ground = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/ground.png\"), tile, tile, false, false);\r\n        breakable = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/break.png\"), tile, tile, false, false);\r\n        unbreak = new Image(getClass().getResourceAsStream(\"/com/client/assets/tiles/unbreak.png\"), tile, tile, false, false);\r\n    }\r\n\r\n    public void render() {\r\n        GraphicsContext g = canvas.getGraphicsContext2D();\r\n        g.setFill(Color.web(\"#2c3e50\")); // Warna Dark Blue-Grey (Ala Discord/Modern UI)\r\n        g.fillRect(0, 0, canvas.getWidth(), canvas.getHeight());\r\n\r\n        double offsetX = canvas.getOffsetX();\r\n        double offsetY = canvas.getOffsetY();\r\n        double scale = canvas.getRenderScale();\r\n\r\n        g.save();\r\n        g.translate(offsetX, offsetY);\r\n        g.scale(scale, scale);\r\n\r\n        // 1. Map\r\n        renderMap(g);\r\n\r\n        // 2. Arena Highlight\r\n        renderArenaShrink(g);\r\n\r\n        // 3. Items (Render item di atas tanah, di bawah player)\r\n        itemManager.render(g);\r\n\r\n        // 4. Objects\r\n        bombs.render(g);\r\n        explosions.render(g);\r\n\r\n        boolean animSelesai = player.isDeathAnimFinished();\r\n\r\n        // Jika animasi BELUM selesai, tetap gambar (biarpun mati)\r\n        // Jika animasi SUDAH selesai, skip baris ini (Player Hilang)\r\n        if (!animSelesai) {\r\n             g.drawImage(player.update(1/60.0), player.x, player.y);\r\n        }\r\n        \r\n        g.restore();\r\n        renderUI(g);\r\n    }\r\n\r\n    private void renderMap(GraphicsContext g) {\r\n        for (int y = 0; y < map[0].length; y++) {\r\n            for (int x = 0; x < map.length; x++) {\r\n                Image img;\r\n                if (map[x][y] == 1) {\r\n                    img = unbreak; \r\n                }else if (map[x][y] == 2) {\r\n                    img = breakable; \r\n                }else {\r\n                    img = ground;\r\n                }\r\n\r\n                g.drawImage(img, x * tile, y * tile);\r\n            }\r\n        }\r\n    }\r\n\r\n    private void renderArenaShrink(GraphicsContext g) {\r\n        if (!arena.isShrinking()) {\r\n            return;\r\n        }\r\n\r\n        double alpha = 0.4 + 0.4 * Math.sin(arena.getShrinkAnimTimer() * 20);\r\n        g.setFill(Color.rgb(255, 0, 0, alpha));\r\n\r\n        int left = arena.getLeft();\r\n        int right = arena.getRight();\r\n        int top = arena.getTop();\r\n        int bottom = arena.getBottom();\r\n\r\n        String step = arena.getCurrentStepPattern();\r\n\r\n        if (\"LR\".equals(step)) {\r\n            g.fillRect(left * 32, 0, 32, map[0].length * 32);\r\n            g.fillRect(right * 32, 0, 32, map[0].length * 32);\r\n        } else if (\"TB\".equals(step)) {\r\n            g.fillRect(0, top * 32, map.length * 32, 32);\r\n            g.fillRect(0, bottom * 32, map.length * 32, 32);\r\n        }\r\n    }\r\n\r\n    private void renderUI(GraphicsContext g) {\r\n        g.save();\r\n        g.setFont(new Font(\"Consolas\", 48));\r\n        g.setFill(Color.WHITE);\r\n        g.setStroke(Color.BLACK);\r\n        g.setLineWidth(2);\r\n        String t = timer.toString();\r\n        g.strokeText(t, canvas.getWidth() - 150, 60);\r\n        g.fillText(t, canvas.getWidth() - 150, 60);\r\n        g.restore();\r\n    }\r\n}\r\n"
        }
    ]
}