{
    "sourceFile": "src/main/java/client/ui/render/GameCanvas.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1764830378859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1764830378859,
            "name": "Commit-0",
            "content": "package com.client.ui.render;\r\n\r\nimport com.client.core.Arena;\r\nimport com.client.core.CollisionHandler;\r\nimport com.client.core.GameTimer;\r\nimport com.client.core.InputHandler;\r\nimport com.client.entities.Player;\r\nimport com.client.managers.BombManager;\r\nimport com.client.managers.ExplosionManager;\r\nimport com.client.managers.ItemManager; \r\nimport com.client.managers.PlayerController;\r\nimport com.client.map.MapGenerator;\r\n\r\nimport javafx.animation.AnimationTimer;\r\nimport javafx.scene.canvas.Canvas;\r\n\r\npublic class GameCanvas extends Canvas {\r\n    private final GameUpdater updater;\r\n    private final GameRenderer renderer;\r\n\r\n    private double renderScale = 1.8;\r\n    private static final double MIN_SCALE = 0.5;\r\n    private static final double MAX_SCALE = 4.0;\r\n    private static final double SCALE_STEP = 0.1;\r\n\r\n    private final int tile = 32;\r\n    private final int[][] map;\r\n    private final Arena arena;\r\n\r\n    // Loop game\r\n    private final AnimationTimer loop = new AnimationTimer() {\r\n        long last = System.nanoTime();\r\n\r\n        @Override\r\n        public void handle(long now) {\r\n            double dt = (now - last) / 1e9;\r\n            last = now;\r\n            updater.update(dt);\r\n            renderer.render();\r\n        }\r\n    };\r\n    \r\n    // Method untuk Stop Loop saat keluar room\r\n    public void stop() {\r\n        loop.stop();\r\n    }\r\n\r\n    // Method untuk Resume Game dari Pause Menu\r\n    public void resume() {\r\n        updater.resumeGame();\r\n    }\r\n\r\n    public GameCanvas(Player player, InputHandler input) {\r\n        int[] spawnPos = new int[2];\r\n        this.map = MapGenerator.generate(13, 13, spawnPos);\r\n        this.arena = new Arena(map);\r\n\r\n        ItemManager itemManager = new ItemManager(tile);\r\n        BombManager bombManager = new BombManager(this);\r\n        ExplosionManager explosionManager = new ExplosionManager(map, itemManager); \r\n        CollisionHandler collider = new CollisionHandler(map, tile);\r\n\r\n        PlayerController playerController = new PlayerController(\r\n                player, input, collider, bombManager, explosionManager, spawnPos\r\n        );\r\n\r\n        CameraScaler scaler = new CameraScaler(this);\r\n        GameTimer timer = new GameTimer(60); \r\n\r\n        renderer = new GameRenderer(this, player, map, bombManager, explosionManager, itemManager, scaler, timer, arena);\r\n        updater = new GameUpdater(playerController, bombManager, explosionManager, itemManager, scaler, timer, arena);\r\n\r\n        bindToScene();\r\n        loop.start();\r\n    }\r\n    \r\n    // ... (kode bindToScene, getters tetap sama) ...\r\n    private void bindToScene() {\r\n        sceneProperty().addListener((obs, oldScene, newScene) -> {\r\n            if (newScene != null) {\r\n                widthProperty().bind(newScene.widthProperty());\r\n                heightProperty().bind(newScene.heightProperty());\r\n                newScene.setOnKeyPressed(e -> {\r\n                    switch (e.getCode()) {\r\n                        case PLUS, ADD, EQUALS -> setRenderScale(renderScale + SCALE_STEP);\r\n                        case MINUS, SUBTRACT -> setRenderScale(renderScale - SCALE_STEP);\r\n                        default -> {}\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n    public void setRenderScale(double s) { renderScale = Math.max(MIN_SCALE, Math.min(MAX_SCALE, s)); }\r\n    public double getRenderScale() { return renderScale; }\r\n    public double getOffsetX() { return (getWidth() - map.length * tile * renderScale) / 2.0; }\r\n    public double getOffsetY() { return (getHeight() - map[0].length * tile * renderScale) / 2.0; }\r\n    public int getTileSize() { return tile; }\r\n}"
        }
    ]
}