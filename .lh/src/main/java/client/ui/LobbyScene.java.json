{
    "sourceFile": "src/main/java/client/ui/LobbyScene.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1764830378833,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1764830378833,
            "name": "Commit-0",
            "content": "package com.client.ui;\r\n\r\nimport java.util.Optional;\r\n\r\nimport javafx.geometry.Insets;\r\nimport javafx.geometry.Pos;\r\nimport javafx.geometry.Rectangle2D;\r\nimport javafx.scene.Scene;\r\nimport javafx.scene.control.Alert;\r\nimport javafx.scene.control.Button;\r\nimport javafx.scene.control.ButtonBar;\r\nimport javafx.scene.control.ButtonType;\r\nimport javafx.scene.control.CheckBox;\r\nimport javafx.scene.control.Dialog;\r\nimport javafx.scene.control.Label;\r\nimport javafx.scene.control.ListView;\r\nimport javafx.scene.control.PasswordField;\r\nimport javafx.scene.control.TextField;\r\nimport javafx.scene.control.TextInputDialog;\r\nimport javafx.scene.layout.BorderPane;\r\nimport javafx.scene.layout.GridPane;\r\nimport javafx.scene.layout.HBox;\r\nimport javafx.scene.layout.VBox;\r\nimport javafx.scene.paint.Color;\r\nimport javafx.scene.text.Font;\r\nimport javafx.scene.text.FontWeight;\r\nimport javafx.stage.Screen;\r\n\r\npublic class LobbyScene {\r\n    private final Scene scene;\r\n\r\n    public LobbyScene() {\r\n        BorderPane root = new BorderPane();\r\n        root.setPadding(new Insets(20));\r\n        root.setStyle(\"-fx-background-color: #2c3e50;\"); \r\n\r\n        // --- HEADER ---\r\n        Label title = new Label(\"GAME LOBBY\");\r\n        title.setFont(Font.font(\"Segoe UI\", FontWeight.BOLD, 32));\r\n        title.setTextFill(Color.WHITE);\r\n        BorderPane.setAlignment(title, Pos.CENTER);\r\n        root.setTop(title);\r\n\r\n        // --- ROOM LIST (CENTER) ---\r\n        ListView<String> roomList = new ListView<>();\r\n        // Note: String \"(Private)\" ini jadi penanda kunci\r\n        roomList.getItems().addAll(\"Room Santai (Public)\", \"Pro Player Only (Private)\", \"Test Room\");\r\n        roomList.setStyle(\"-fx-control-inner-background: #34495e; -fx-text-fill: white;\");\r\n        \r\n        VBox centerBox = new VBox(10, new Label(\"Available Rooms:\") {{ setTextFill(Color.WHITE); }}, roomList);\r\n        centerBox.setPadding(new Insets(20, 0, 20, 0));\r\n        root.setCenter(centerBox);\r\n\r\n        // --- BUTTONS (BOTTOM) ---\r\n        Button btnJoin = new Button(\"Join Selected Room\");\r\n        Button btnCreate = new Button(\"Create New Room\");\r\n        styleButton(btnJoin);\r\n        styleButton(btnCreate);\r\n\r\n        HBox bottomBox = new HBox(15, btnJoin, btnCreate);\r\n        bottomBox.setAlignment(Pos.CENTER);\r\n        root.setBottom(bottomBox);\r\n\r\n        // --- LOGIC ---\r\n        btnCreate.setOnAction(e -> showCreateRoomDialog());\r\n        \r\n        // UPDATE LOGIC JOIN: Cek Public/Private\r\n        btnJoin.setOnAction(e -> {\r\n            String selected = roomList.getSelectionModel().getSelectedItem();\r\n            if (selected != null) {\r\n                // Cek apakah string mengandung kata \"Private\"\r\n                if (selected.contains(\"(Private)\")) {\r\n                    showPasswordDialog(selected);\r\n                } else {\r\n                    // Kalau Public langsung masuk\r\n                    SceneManager.toRoom(selected, false);\r\n                }\r\n            }\r\n        });\r\n\r\n        Rectangle2D screenBounds = Screen.getPrimary().getVisualBounds();\r\n        this.scene = new Scene(root, screenBounds.getWidth(), screenBounds.getHeight());\r\n    }\r\n\r\n    // Method baru untuk validasi password\r\n    private void showPasswordDialog(String roomName) {\r\n        TextInputDialog dialog = new TextInputDialog();\r\n        dialog.setTitle(\"Private Room\");\r\n        dialog.setHeaderText(\"Room ini dikunci (Private)\");\r\n        dialog.setContentText(\"Masukkan Password (Hint: 1234):\");\r\n\r\n        Optional<String> result = dialog.showAndWait();\r\n        result.ifPresent(password -> {\r\n            // Simulasi validasi password sederhana\r\n            if (password.equals(\"1234\")) {\r\n                SceneManager.toRoom(roomName, false);\r\n            } else {\r\n                Alert alert = new Alert(Alert.AlertType.ERROR);\r\n                alert.setTitle(\"Access Denied\");\r\n                alert.setHeaderText(\"Password Salah!\");\r\n                alert.setContentText(\"Kamu tidak bisa masuk ke room ini.\");\r\n                alert.showAndWait();\r\n            }\r\n        });\r\n    }\r\n\r\n    private void showCreateRoomDialog() {\r\n        Dialog<String> dialog = new Dialog<>();\r\n        dialog.setTitle(\"Create Room\");\r\n        dialog.setHeaderText(\"Room Settings\");\r\n\r\n        ButtonType createBtnType = new ButtonType(\"Create\", ButtonBar.ButtonData.OK_DONE);\r\n        dialog.getDialogPane().getButtonTypes().addAll(createBtnType, ButtonType.CANCEL);\r\n\r\n        GridPane grid = new GridPane();\r\n        grid.setHgap(10); grid.setVgap(10);\r\n        grid.setPadding(new Insets(20, 150, 10, 10));\r\n\r\n        TextField roomName = new TextField();\r\n        roomName.setPromptText(\"Room Name\");\r\n        PasswordField password = new PasswordField();\r\n        password.setPromptText(\"Password (Optional)\");\r\n        \r\n        CheckBox isPrivate = new CheckBox(\"Private Room\");\r\n        isPrivate.setOnAction(e -> password.setDisable(!isPrivate.isSelected()));\r\n        password.setDisable(true); \r\n\r\n        grid.add(new Label(\"Name:\"), 0, 0);\r\n        grid.add(roomName, 1, 0);\r\n        grid.add(isPrivate, 0, 1);\r\n        grid.add(password, 1, 1);\r\n\r\n        dialog.getDialogPane().setContent(grid);\r\n\r\n        dialog.setResultConverter(dialogButton -> {\r\n            if (dialogButton == createBtnType) {\r\n                // Return format nama room (Simulasi)\r\n                String name = roomName.getText();\r\n                if (isPrivate.isSelected()) {\r\n                    return name + \" (Private)\";\r\n                }\r\n                return name + \" (Public)\";\r\n            }\r\n            return null;\r\n        });\r\n\r\n        dialog.showAndWait().ifPresent(finalName -> {\r\n            if (!finalName.isEmpty()) SceneManager.toRoom(finalName, true); \r\n        });\r\n    }\r\n\r\n    private void styleButton(Button btn) {\r\n        btn.setStyle(\"-fx-background-color: #e67e22; -fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;\");\r\n        btn.setPrefWidth(150);\r\n        btn.setPrefHeight(40);\r\n    }\r\n\r\n    public Scene getScene() { return scene; }\r\n}"
        }
    ]
}